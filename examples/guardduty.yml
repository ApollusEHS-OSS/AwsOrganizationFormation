AWSTemplateFormatVersion: '2010-09-09-OC'
Description: default template generated for organization with master account 507468909204

Organization: !Include ./organization.yml

Resources:
  Detector:
    Type: AWS::GuardDuty::Detector
    OrganizationBindings:
      Accounts: '*'
      IncludeMasterAccount: true
      Regions: eu-central-1
    Properties:
      Enable: 'true'
  Master:
    Type: AWS::GuardDuty::Master
    OrganizationBindings:
      Accounts: '*'
      Regions: eu-central-1
    Properties:
      DetectorId: !Ref Detector
      InvitationId: !Ref MemberInvitation
      MasterId: !Ref MasterAccount
  Member:
    Type: AWS::GuardDuty::Member
    OrganizationBindings:
      IncludeMasterAccount: true
      Regions: eu-central-1
    Foreach:
      Accounts: '*'
    Properties:
      DetectorId: !Ref Detector
      Email: !GetAtt CurrentAccount.RootEmail
      MemberId: !Ref CurrentAccount
      Status: Invited
      DisableEmailNotification: true

